<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guardi√£o Verde - Seu Jardineiro Virtual</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        .floating {
            animation: float 4s ease-in-out infinite;
        }
        .pulse {
            animation: pulse 2s ease-in-out infinite;
        }
        .chat-bubble {
            border-radius: 20px;
            position: relative;
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.3s ease;
        }
        .chat-bubble.visible {
            opacity: 1;
            transform: translateY(0);
        }
        .caret {
            position: absolute;
            bottom: -10px;
            left: 20px;
            width: 0; 
            height: 0; 
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-top: 10px solid #F0FDF4;
        }
        .progress-bar {
            height: 10px;
            border-radius: 5px;
            transition: width 0.5s ease;
        }
    </style>
</head>
<body class="bg-emerald-50 min-h-screen flex flex-col items-center p-4">
    <div class="w-full max-w-4xl mx-auto">
        <header class="text-center mb-8">
            <div class="flex justify-center items-center mb-4">
                <img src="https://placehold.co/80x80" alt="√çcone de planta em um vaso com folhas verdes vibrantes" class="w-16 h-16 mr-4">
                <h1 class="text-4xl font-bold text-emerald-800">Guardi√£o Verde</h1>
            </div>
            <p class="text-lg text-emerald-700">Seu jardineiro virtual para cuidar perfeito das suas plantas</p>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <div class="lg:col-span-1 bg-white rounded-xl shadow-lg overflow-hidden">
                <div class="p-4 bg-emerald-600 text-white">
                    <h2 class="text-xl font-semibold">Seu Jardineiro Virtual</h2>
                </div>
                <div class="p-4 flex flex-col items-center">
                    <div class="floating mb-4">
                        <img src="https://placehold.co/200x300" alt="Jardineiro virtual animado, um homem gentil com chap√©u de palha, avental de jardineiro e sorriso amig√°vel, segurando uma p√° de jardim" class="w-full h-auto rounded-lg">
                    </div>
                    
                    <div class="w-full mt-2">
                        <div id="gardener-chat" class="chat-bubble bg-emerald-100 p-4 mb-4">
                            <p class="text-emerald-800" id="gardener-message">Ol√°, jardineiro! Estou aqui para te ajudar a cuidar da sua planta. Vamos come√ßar?</p>
                            <div class="caret"></div>
                        </div>
                    </div>
                    
                    <div class="w-full mt-4" id="chat-container">
                        <input type="text" id="user-question" placeholder="Pergunte ao jardineiro..." class="w-full px-4 py-2 border border-emerald-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500">
                        <button id="ask-btn" class="mt-2 w-full bg-emerald-600 hover:bg-emerald-700 text-white font-medium py-2 px-4 rounded-lg transition duration-200">
                            Perguntar
                        </button>
                    </div>
                </div>
            </div>

            <div class="lg:col-span-2 bg-white rounded-xl shadow-lg overflow-hidden">
                <div class="p-4 bg-emerald-700 text-white">
                    <h2 class="text-xl font-semibold">Cuide da Sua Planta</h2>
                </div>
                <div class="p-6" id="game-container">
                    <div id="plant-status" class="flex items-center justify-between mb-6 p-4 bg-emerald-50 rounded-lg">
                        <div>
                            <h3 class="text-lg font-medium text-emerald-800" id="plant-title">Sua Planta Virtual</h3>
                            <div class="flex items-center mt-1">
                                <span class="text-emerald-600 mr-2">Sa√∫de:</span>
                                <div class="flex-1 bg-gray-200 rounded-full h-2.5">
                                    <div class="progress-bar bg-emerald-500 h-2.5 rounded-full" style="width: 100%" id="health-bar"></div>
                                </div>
                                <span class="text-emerald-600 font-bold ml-2" id="health-percentage">100%</span>
                            </div>
                        </div>
                        <div class="text-5xl pulse" id="plant-emoji">üå±</div>
                    </div>

                    <div id="caixa-perguntas" class="mb-6 p-4 bg-amber-50 rounded-lg">
                        <p class="text-amber-800" id="question-text">Bem-vindo ao Guardi√£o Verde! Antes de come√ßar, qual √© o nome da sua planta?</p>
                    </div>

                    <div id="name-input" style="display: block;">
                        <input type="text" id="plant-name-input" placeholder="Digite o nome da sua planta" class="w-full px-4 py-2 border border-amber-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500">
                        <button id="start-btn" class="mt-2 w-full bg-amber-500 hover:bg-amber-600 text-white font-medium py-2 px-4 rounded-lg transition duration-200">
                            Come√ßar
                        </button>
                    </div>
                    
                    <div id="care-tips" class="p-4 bg-blue-50 rounded-lg my-4 hidden">
                        <h4 class="font-medium text-blue-800 mb-2">Dica do Jardineiro:</h4>
                        <p id="tip-content" class="text-blue-700"></p>
                    </div>

                    <div id="caixa-alternativas" class="grid grid-cols-1 md:grid-cols-2 gap-3 mb-6" style="display: none;"></div>

                    <div id="caixa-resultado" class="p-4 bg-emerald-50 rounded-lg hidden">
                        <h3 class="text-lg font-medium text-emerald-800 mb-2">Resultado Final</h3>
                        <p id="texto-resultado" class="text-gray-700 mb-4"></p>
                        <div class="flex justify-center">
                            <button id="restart-btn" class="bg-emerald-600 hover:bg-emerald-700 text-white font-medium py-2 px-4 rounded-lg transition duration-200">
                                Jogar Novamente
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Elementos do DOM
            const gardenerMessage = document.getElementById('gardener-message');
            const questionText = document.getElementById('question-text');
            const plantTitle = document.getElementById('plant-title');
            const healthBar = document.getElementById('health-bar');
            const healthPercentage = document.getElementById('health-percentage');
            const plantEmoji = document.getElementById('plant-emoji');
            const plantNameInput = document.getElementById('plant-name-input');
            const startBtn = document.getElementById('start-btn');
            const careTips = document.getElementById('care-tips');
            const tipContent = document.getElementById('tip-content');
            const userQuestion = document.getElementById('user-question');
            const askBtn = document.getElementById('ask-btn');
            const restartBtn = document.getElementById('restart-btn');
            const chatContainer = document.getElementById('chat-container');
            const caixaPerguntas = document.getElementById('caixa-perguntas');
            const caixaAlternativas = document.getElementById('caixa-alternativas');
            const caixaResultado = document.getElementById('caixa-resultado');

            // Vari√°veis do jogo
            let plantName = '';
            let health = 100;
            let currentQuestionIndex = 0;
            let history = [];
            let plantStage = 'seed';
            
            // Mapeamento de √°udios
            const audios = {
                'regou_certo': new Audio('regador.mp3'),
                'esperou_demais': new Audio('grilo.mp3'),
                'afogou_planta': new Audio('afoga.mp3'),
                'verificou_solo': new Audio('ta seco.mp3'),
                'adubou_planta': new Audio('audios/adubou_planta.mp3'),
                'deu_mais_luz': new Audio('audios/deu_mais_luz.mp3'),
                'reduziu_agua': new Audio('audios/reduziu_agua.mp3'),
                'ignorou_problema': new Audio('/tmp/guest-fff2tj/Downloads/GUSTAVO-DECISOES-main/AUDIO/WhatsApp Audio 2025-08-11 at 11.43.39.mp3'),
                'inseticida_quimico': new Audio('audios/inseticida_quimico.mp3'),
                'lavou_folhas': new Audio('audios/lavou_folhas.mp3'),
                'oleo_de_neem': new Audio('audios/oleo_de_neem.mp3'),
                'isolou_planta': new Audio('audios/isolou_planta.mp3'),
                'vaso_maior': new Audio('apertado.mp3'),
                'fez_poda': new Audio('audios/fez_poda.mp3'),
                'cresceu_livremente': new Audio('audios/cresceu_livremente.mp3'),
                'multiplicou_planta': new Audio('audios/multiplicou_planta.mp3'),
                'adubou_corretamente': new Audio('audios/adubou_corretamente.mp3'),
                'fertilizou_demais': new Audio('audios/fertilizou_demais.mp3'),
                'nao_fertilizou': new Audio('audios/nao_fertilizou.mp3'),
                'manchas_nao_identificadas': new Audio('audios/manchas_nao_identificadas.mp3'),
                'folhas_com_manchas': new Audio('audios/folhas_com_manchas.mp3'),
                'fungicida_natural': new Audio('audios/fungicida_natural.mp3'),
                'removeu_folhas': new Audio('audios/removeu_folhas.mp3'),
                'parabens': new Audio('audios/parabens.mp3'),
                'bom_trabalho': new Audio('audios/bom_trabalho.mp3'),
                'precisou_de_ajuda': new Audio('audios/precisou_de_ajuda.mp3'),
                'nao_resistiu': new Audio('audios/nao_resistiu.mp3'),
                'plant_chat_default': new Audio('audios/plant_chat_default.mp3'),
                'bem_vindo': new Audio('audios/bem_vindo.mp3')
            };

            function playAudio(key) {
                if (audios[key]) {
                    audios[key].play();
                } else {
                    console.error('√Åudio n√£o encontrado:', key);
                }
            }
            
            function showGardenerChat(message, audioKey) {
                gardenerMessage.textContent = message;
                const chatBubble = document.getElementById('gardener-chat');
                chatBubble.classList.remove('visible');
                setTimeout(() => {
                    chatBubble.classList.add('visible');
                    if (audioKey) {
                        playAudio(audioKey);
                    }
                }, 10);
            }

            // Perguntas e alternativas
            const questions = [
                {
                    question: "A terra da sua planta est√° seca. O que voc√™ faz?",
                    emoji: "üå±",
                    alternatives: [
                        {
                            text: "Rego imediatamente",
                            points: 10,
                            response: "Voc√™ regou a planta na medida certa!",
                            tip: "Regue quando o solo estiver seco ao toque, mas n√£o encharcado. O ideal √© checar com o dedo.",
                            audio: 'regou_certo'
                        },
                        {
                            text: "Espero mais um pouco",
                            points: -5,
                            response: "Voc√™ esperou demais e a planta ficou com sede!",
                            tip: "Plantas jovens precisam de rega mais frequente. N√£o deixe o solo secar completamente.",
                            audio: 'esperou_demais'
                        },
                        {
                            text: "Rego abundantemente",
                            points: -15,
                            response: "Voc√™ afogou a planta com √°gua demais!",
                            tip: "Excesso de √°gua pode apodrecer as ra√≠zes. Sempre verifique a drenagem do vaso.",
                            audio: 'afogou_planta'
                        },
                        {
                            text: "Verifico se realmente precisa",
                            points: 15,
                            response: "Voc√™ verificou a umidade do solo antes de regar - excelente!",
                            tip: "Sempre cheque 2-3 cm abaixo da superf√≠cie para ver se precisa regar.",
                            audio: 'verificou_solo'
                        }
                    ]
                },
                {
                    question: "Voc√™ nota que as folhas est√£o ficando amarelas. O que voc√™ faz?",
                    emoji: "üçÇ",
                    alternatives: [
                        {
                            text: "Adubo a planta",
                            points: 5,
                            response: "Voc√™ adubou a planta para nutri-la!",
                            tip: "Folhas amarelas podem indicar falta de nutrientes. Mas tamb√©m pode ser excesso de √°gua, ent√£o √© bom verificar o solo antes.",
                            audio: 'adubou_planta'
                        },
                        {
                            text: "Mudo para um lugar mais ensolarado",
                            points: 10,
                            response: "Voc√™ deu mais luz para a planta!",
                            tip: "Luz insuficiente pode causar amarelecimento. Mude a planta para um local com mais luz indireta.",
                            audio: 'deu_mais_luz'
                        },
                        {
                            text: "Reduzo a quantidade de √°gua",
                            points: 15,
                            response: "Voc√™ identificou o excesso de √°gua - √≥timo!",
                            tip: "Excesso de √°gua √© a causa mais comum de folhas amarelas. Deixe o solo secar um pouco mais entre as regas.",
                            audio: 'reduziu_agua'
                        },
                        {
                            text: "N√£o fa√ßo nada",
                            points: -10,
                            response: "Voc√™ ignorou o problema e a planta piorou!",
                            tip: "Folhas amareladas sempre indicam algum problema que precisa ser resolvido. N√£o ignore os sinais.",
                            audio: 'ignorou_problema'
                        }
                    ]
                },
                {
                    question: "Apareceram pequenos insetos na planta. O que voc√™ faz?",
                    emoji: "üêõ",
                    alternatives: [
                        {
                            text: "Uso inseticida qu√≠mico",
                            points: -5,
                            response: "O inseticida forte pode prejudicar a planta!",
                            tip: "Inseticidas qu√≠micos devem ser o √∫ltimo recurso, pois podem ser agressivos. Tente solu√ß√µes naturais primeiro.",
                            audio: 'inseticida_quimico'
                        },
                        {
                            text: "Lavo as folhas com √°gua",
                            points: 5,
                            response: "Voc√™ removeu manualmente os invasores!",
                            tip: "Lavar as folhas com um jato suave de √°gua remove muitos insetos sem a necessidade de produtos qu√≠micos.",
                            audio: 'lavou_folhas'
                        },
                        {
                            text: "Uso √≥leo de neem",
                            points: 20,
                            response: "Voc√™ usou um rem√©dio natural eficaz!",
                            tip: "√ìleo de neem √© o melhor tratamento org√¢nico para pragas. √â seguro para a planta e eficiente contra a maioria dos insetos.",
                            audio: 'oleo_de_neem'
                        },
                        {
                            text: "Isole a planta das outras",
                            points: 10,
                            response: "Voc√™ impediu que a praga se espalhasse!",
                            tip: "Isolar plantas doentes ou com pragas evita a contamina√ß√£o de outras plantas saud√°veis. √â a primeira medida a ser tomada.",
                            audio: 'isolou_planta'
                        }
                    ]
                },
                {
                    question: "Sua planta est√° crescendo muito. O que voc√™ faz?",
                    emoji: "üåø",
                    alternatives: [
                        {
                            text: "Transplanto para um vaso maior",
                            points: 15,
                            response: "Voc√™ deu mais espa√ßo para as ra√≠zes crescerem!",
                            tip: "Transplante quando as ra√≠zes sa√≠rem pelos furos do vaso. Use um vaso apenas 5-10 cm maior que o atual.",
                            audio: 'vaso_maior'
                        },
                        {
                            text: "Podo os galhos",
                            points: 10,
                            response: "Voc√™ fez uma poda para manter o formato!",
                            tip: "Podar estimula o crescimento de novos brotos, deixando a planta mais cheia e bonita.",
                            audio: 'fez_poda'
                        },
                        {
                            text: "Deixo crescer livremente",
                            points: 5,
                            response: "Voc√™ deixou a planta seguir seu curso natural!",
                            tip: "Algumas plantas ficam lindas quando crescem livremente, sem podas. Observe a esp√©cie da sua planta.",
                            audio: 'cresceu_livremente'
                        },
                        {
                            text: "Divido a planta em duas",
                            points: 20,
                            response: "Voc√™ multiplicou sua planta - excelente!",
                            tip: "Dividir √© √≥timo para plantas que formam touceiras, como a espada-de-s√£o-jorge. Isso cria novas plantas.",
                            audio: 'multiplicou_planta'
                        }
                    ]
                },
                {
                    question: "Voc√™ decide fertilizar sua planta. Qual a melhor abordagem?",
                    emoji: "üß™",
                    alternatives: [
                        {
                            text: "Adicionar muito fertilizante de uma vez",
                            points: -20,
                            response: "Voc√™ exagerou no fertilizante e queimou as ra√≠zes da planta!",
                            tip: "O excesso de fertilizante √© prejudicial. Mais n√£o √© sin√¥nimo de melhor! Sempre siga as instru√ß√µes da embalagem.",
                            audio: 'fertilizou_demais'
                        },
                        {
                            text: "N√£o fertilizar nunca",
                            points: -10,
                            response: "A planta ficou fraca por falta de nutrientes!",
                            tip: "A fertiliza√ß√£o √© essencial para a maioria das plantas durante a fase de crescimento. Sem nutrientes, elas n√£o se desenvolvem bem.",
                            audio: 'nao_fertilizou'
                        },
                        {
                            text: "Fertilizar em pequenas doses, seguindo as instru√ß√µes",
                            points: 20,
                            response: "Voc√™ fertilizou a planta na dose certa. √ìtimo!",
                            tip: "A fertiliza√ß√£o deve ser feita em doses pequenas e regulares, especialmente na primavera e no ver√£o, quando a planta est√° em crescimento ativo.",
                            audio: 'adubou_corretamente'
                        },
                        {
                            text: "Fertilizar apenas no inverno",
                            points: -5,
                            response: "Voc√™ fertilizou na √©poca errada. O crescimento da planta √© menor no inverno!",
                            tip: "Fertilize a planta apenas durante as esta√ß√µes de crescimento (primavera/ver√£o). No inverno, as plantas entram em dorm√™ncia e n√£o precisam de adubo.",
                            audio: 'nao_fertilizou'
                        }
                    ]
                },
                {
                    question: "Voc√™ nota pequenas manchas marrons nas folhas. O que faz?",
                    emoji: "üçÑ",
                    alternatives: [
                        {
                            text: "Ignorar e esperar passar",
                            points: -10,
                            response: "Voc√™ ignorou as manchas, e a doen√ßa se espalhou!",
                            tip: "Manchas marrons podem indicar doen√ßas f√∫ngicas. √â importante agir r√°pido para evitar que se espalhem para outras partes da planta.",
                            audio: 'manchas_nao_identificadas'
                        },
                        {
                            text: "Aplicar √°gua nas folhas",
                            points: -5,
                            response: "A √°gua pode piorar o problema, j√° que alguns fungos se espalham com a umidade!",
                            tip: "Molhar as folhas √© contraindicado quando h√° suspeita de fungos. A umidade facilita a prolifera√ß√£o de doen√ßas.",
                            audio: 'folhas_com_manchas'
                        },
                        {
                            text: "Remover as folhas afetadas e aplicar fungicida natural",
                            points: 20,
                            response: "Voc√™ tratou o problema de forma eficaz e natural!",
                            tip: "Remover as folhas doentes e usar um fungicida natural (como √≥leo de neem ou solu√ß√£o de bicarbonato) √© o melhor caminho para combater os fungos.",
                            audio: 'fungicida_natural'
                        },
                        {
                            text: "Arrancar a planta e jogar fora",
                            points: -50,
                            response: "N√£o precisava disso! A planta ainda tinha salva√ß√£o!",
                            tip: "Quase todos os problemas de plantas podem ser resolvidos com o tratamento correto. Desistir da planta √© a √∫ltima op√ß√£o.",
                            audio: 'removeu_folhas'
                        }
                    ]
                }
            ];

            // Base de conhecimento do jardineiro (IA simulada)
            const gardeningKnowledge = {
                '√°gua': {
                    response: 'Regue sua planta quando o solo estiver seco ao toque. A frequ√™ncia ideal depende da esp√©cie, temperatura e umidade do ambiente. Uma boa dica √© verificar 2-3 cm abaixo da superf√≠cie - se estiver seco, √© hora de regar.',
                    audio: 'plant_chat_default'
                },
                'luz': {
                    response: 'A maioria das plantas de interior precisa de luz indireta brilhante por 6-8 horas ao dia. Observe as folhas - se estiverem p√°lidas ou alongadas, pode ser falta de luz. Se tiverem manchas marrons, pode ser excesso de sol direto.',
                    audio: 'plant_chat_default'
                },
                'adubo': {
                    response: 'Adube a cada 4-6 semanas na primavera e ver√£o. Use um fertilizante balanceado (10-10-10) dilu√≠do. No outono e inverno, reduza para a cada 8-10 semanas ou pare completamente, conforme a esp√©cie.',
                    audio: 'plant_chat_default'
                },
                'folhas amarelas': {
                    response: 'Folhas amarelas podem ter v√°rias causas: excesso de √°gua (mais comum), falta de nutrientes, pragas ou luz inadequada. Verifique primeiro a umidade do solo e examine as folhas por insetos.',
                    audio: 'plant_chat_default'
                },
                'pragas': {
                    response: 'Para pragas comuns como pulg√µes ou √°caros, use uma solu√ß√£o de √°gua com sab√£o neutro (1 colher por litro) ou √≥leo de neem. Aplique a cada 3-5 dias at√© resolver. Sempre isole a planta afetada.',
                    audio: 'plant_chat_default'
                },
                'transplante': {
                    response: 'Transplante quando: 1) as ra√≠zes sa√≠rem pelo fundo do vaso, 2) a planta parar de crescer, ou 3) a √°gua escorrer muito r√°pido (sinal de muitas ra√≠zes). Use um vaso apenas 5-10 cm maior que o atual.',
                    audio: 'plant_chat_default'
                },
                'default': {
                    response: 'Como jardineiro virtual, posso te ajudar com d√∫vidas sobre rega, ilumina√ß√£o, aduba√ß√£o, pragas e outros cuidados com plantas. O que mais voc√™ gostaria de saber?',
                    audio: 'plant_chat_default'
                }
            };
            
            // Fun√ß√£o para atualizar a sa√∫de da planta
            function updateHealth(points) {
                health = Math.max(0, Math.min(100, health + points));
                healthBar.style.width = `${health}%`;
                healthPercentage.textContent = `${health}%`;
                
                if (health > 70) {
                    healthBar.className = 'progress-bar bg-emerald-500 h-2.5 rounded-full';
                    plantEmoji.className = 'text-5xl pulse';
                } else if (health > 30) {
                    healthBar.className = 'progress-bar bg-amber-300 h-2.5 rounded-full';
                    plantEmoji.className = 'text-5xl';
                } else {
                    healthBar.className = 'progress-bar bg-red-500 h-2.5 rounded-full';
                    plantEmoji.className = 'text-5xl';
                }
                
                updatePlantStage();
            }

            // Fun√ß√£o para atualizar o est√°gio da planta
            function updatePlantStage() {
                if (health <= 0) {
                    plantStage = 'dead';
                    plantEmoji.textContent = 'üíÄ';
                } else if (health <= 30) {
                    plantStage = 'sick';
                    plantEmoji.textContent = 'üçÇ';
                } else if (health <= 60) {
                    plantStage = 'young';
                    plantEmoji.textContent = 'üå±';
                } else if (health <= 90) {
                    plantStage = 'healthy';
                    plantEmoji.textContent = 'üåø';
                } else {
                    plantStage = 'thriving';
                    plantEmoji.textContent = 'üå∏';
                }
            }

            // Fun√ß√£o para mostrar uma pergunta
            function showQuestion(index) {
                const questionData = questions[index];
                const alternativesContainer = document.getElementById('caixa-alternativas');
                
                questionText.textContent = questionData.question;
                plantEmoji.textContent = questionData.emoji;
                alternativesContainer.innerHTML = '';
                
                // Limpar e ocultar a dica anterior
                tipContent.textContent = '';
                careTips.classList.add('hidden');
                
                // Mostrar a dica do jardineiro ANTES da pergunta
                const randomAlt = questionData.alternatives[Math.floor(Math.random() * questionData.alternatives.length)];
                tipContent.textContent = randomAlt.tip;
                careTips.classList.remove('hidden');

                questionData.alternatives.forEach((alt) => {
                    const button = document.createElement('button');
                    button.className = 'bg-white hover:bg-emerald-50 text-emerald-800 font-medium py-3 px-4 border border-emerald-200 rounded-lg transition duration-200';
                    button.textContent = alt.text;
                    
                    button.addEventListener('click', () => {
                        updateHealth(alt.points);
                        history.push(alt.response);
                        showGardenerChat(alt.response, alt.audio);
                        
                        // Avan√ßar para pr√≥xima pergunta ou finalizar
                        currentQuestionIndex++;
                        if (currentQuestionIndex < questions.length) {
                            setTimeout(() => {
                                showQuestion(currentQuestionIndex);
                            }, 3000);
                        } else {
                            setTimeout(showFinalResult, 3000);
                        }
                    });
                    
                    alternativesContainer.appendChild(button);
                });
                
                caixaPerguntas.classList.remove('hidden');
                caixaAlternativas.style.display = 'grid';
                caixaResultado.classList.add('hidden');
                chatContainer.style.display = 'none'; // Esconde o chat do jardineiro durante o jogo
            }

            // Fun√ß√£o para mostrar resultado final
            function showFinalResult() {
                let result = '';
                let gardenerComment = '';
                let audioKey = '';
                
                if (health > 80) {
                    result = `Parab√©ns! ${plantName} est√° florescendo lindamente sob seus cuidados. Voc√™ √© um excelente jardineiro!`;
                    gardenerComment = `üë®‚Äçüåæ "Voc√™ tem um verdadeiro dom para cuidar de plantas! ${plantName} est√° radiante!"`;
                    audioKey = 'parabens';
                } else if (health > 50) {
                    result = `Bom trabalho! ${plantName} est√° saud√°vel, mas pode melhorar com alguns ajustes. Continue aprendendo!`;
                    gardenerComment = `üë®‚Äçüåæ "Com mais um pouco de pr√°tica, voc√™ ser√° um expert! ${plantName} agradece seus cuidados."`;
                    audioKey = 'bom_trabalho';
                } else if (health > 20) {
                    result = `${plantName} sobreviveu, mas precisou de ajuda. Revise as dicas do jardineiro para melhorar.`;
                    gardenerComment = `üë®‚Äçüåæ "Todo jardineiro come√ßa assim. N√£o desista! Eu te ajudo a cuidar melhor da ${plantName}."`;
                    audioKey = 'precisou_de_ajuda';
                } else {
                    result = `Infelizmente ${plantName} n√£o resistiu. Mas n√£o desanime! Tente novamente com as dicas aprendidas.`;
                    gardenerComment = `üë®‚Äçüåæ "√Äs vezes acontece... Que tal come√ßar de novo? Prometo te ajudar melhor desta vez!"`;
                    audioKey = 'nao_resistiu';
                }
                
                result += '\n\nSuas a√ß√µes:\n';
                history.forEach((action, i) => {
                    result += `\n${i + 1}. ${action}`;
                });
                
                document.getElementById('texto-resultado').innerHTML = result.replace(/\n/g, '<br>');
                showGardenerChat(gardenerComment, audioKey);
                
                caixaPerguntas.classList.add('hidden');
                caixaAlternativas.style.display = 'none';
                careTips.classList.add('hidden');
                caixaResultado.classList.remove('hidden');
                chatContainer.style.display = 'block'; // Mostra o chat novamente no final
            }

            // Fun√ß√£o para reiniciar o jogo
            function restartGame() {
                currentQuestionIndex = 0;
                health = 100;
                history = [];
                plantStage = 'seed';
                
                updateHealth(0);
                plantEmoji.textContent = 'üå±';
                document.getElementById('texto-resultado').textContent = '';
                caixaResultado.classList.add('hidden');
                document.getElementById('name-input').style.display = 'block';
                plantNameInput.value = '';
                questionText.textContent = `Bem-vindo ao Guardi√£o Verde! Antes de come√ßar, qual √© o nome da sua planta?`;
                showGardenerChat(`Ol√°, jardineiro! Estou aqui para te ajudar a cuidar da sua planta. Vamos come√ßar?`, 'bem_vindo');
                chatContainer.style.display = 'block';
            }

            // Event listeners
            startBtn.addEventListener('click', () => {
                plantName = plantNameInput.value.trim() || 'Planta';
                plantTitle.textContent = plantName;
                document.getElementById('name-input').style.display = 'none';
                showGardenerChat(`√ìtimo escolher um nome para sua planta! ${plantName} ser√° bem cuidada com voc√™.`);
                setTimeout(() => showQuestion(0), 2000);
            });

            askBtn.addEventListener('click', () => {
                const question = userQuestion.value.trim().toLowerCase();
                if (!question) return;
                
                let responseKey = Object.keys(gardeningKnowledge).find(key => 
                    question.includes(key)
                ) || 'default';
                
                const response = gardeningKnowledge[responseKey];
                showGardenerChat(response.response, response.audio);
                userQuestion.value = '';
            });

            userQuestion.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    askBtn.click();
                }
            });

            restartBtn.addEventListener('click', restartGame);

            // Toca √°udio inicial ao carregar a p√°gina
            playAudio('bem_vindo');
        });
    </script>
</body>
</html>
